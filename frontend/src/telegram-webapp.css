/* Telegram WebApp styling */
:root {
  /* Light theme defaults */
  --tg-bg-color: #ffffff;
  --tg-text-color: #000000;
  --tg-hint-color: #999999;
  --tg-link-color: #007aff;
  --tg-button-color: #007aff;
  --tg-button-text-color: #ffffff;
  --tg-secondary-bg-color: #f0f0f0;
}

[data-theme="dark"] {
  /* Dark theme defaults */
  --tg-bg-color: #1c1c1e;
  --tg-text-color: #ffffff;
  --tg-hint-color: #8e8e93;
  --tg-link-color: #0a84ff;
  --tg-button-color: #0a84ff;
  --tg-button-text-color: #ffffff;
  --tg-secondary-bg-color: #2c2c2e;
}

.telegram-webapp {
  background-color: var(--tg-bg-color);
  color: var(--tg-text-color);
  min-height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}

/* Remove default body margin and padding for full screen experience */
body {
  margin: 0;
  padding: 0;
  background-color: var(--tg-bg-color);
}

/* Button styling that matches Telegram theme */
.tg-button {
  background-color: var(--tg-button-color);
  color: var(--tg-button-text-color);
  border: none;
  border-radius: 8px;
  padding: 12px 24px;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: opacity 0.2s;
}

.tg-button:hover {
  opacity: 0.8;
}

.tg-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Secondary button styling */
.tg-button-secondary {
  background-color: var(--tg-secondary-bg-color);
  color: var(--tg-text-color);
  border: 1px solid var(--tg-hint-color);
}

/* Link styling */
.tg-link {
  color: var(--tg-link-color);
  text-decoration: none;
}

.tg-link:hover {
  text-decoration: underline;
}

/* Text styling */
.tg-hint {
  color: var(--tg-hint-color);
}

/* Card/panel styling */
.tg-card {
  background-color: var(--tg-secondary-bg-color);
  border-radius: 12px;
  padding: 16px;
  margin: 8px 0;
}

/* ========================================
   MOBILE SAFE AREAS IMPLEMENTATION
   Comprehensive support for all device orientations and notches
   ======================================== */

/* Define safe area CSS custom properties with fallbacks */
:root {
  /* Safe area insets with fallbacks for non-supporting browsers */
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);

  /* Additional safe area properties for fine-grained control */
  --safe-area-header-height: max(44px, var(--safe-area-inset-top));
  --safe-area-footer-height: max(34px, var(--safe-area-inset-bottom));

  /* Dynamic content padding based on safe areas */
  --content-padding-top: max(20px, var(--safe-area-inset-top));
  --content-padding-bottom: max(20px, var(--safe-area-inset-bottom));
  --content-padding-horizontal: max(16px, var(--safe-area-inset-left), var(--safe-area-inset-right));
}

/* Main app container with comprehensive safe area support */
.telegram-webapp {
  /* Apply safe area padding on all sides */
  padding-top: var(--safe-area-inset-top);
  padding-right: var(--safe-area-inset-right);
  padding-bottom: var(--safe-area-inset-bottom);
  padding-left: var(--safe-area-inset-left);

  /* Ensure full viewport coverage including safe areas */
  min-height: 100vh;
  min-height: 100dvh; /* Dynamic viewport height for better mobile support */

  /* iOS viewport meta support */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Safe area utilities for specific positioning needs */
.safe-area-top {
  padding-top: var(--safe-area-inset-top);
}

.safe-area-right {
  padding-right: var(--safe-area-inset-right);
}

.safe-area-bottom {
  padding-bottom: var(--safe-area-inset-bottom);
}

.safe-area-left {
  padding-left: var(--safe-area-inset-left);
}

.safe-area-horizontal {
  padding-left: var(--safe-area-inset-left);
  padding-right: var(--safe-area-inset-right);
}

.safe-area-vertical {
  padding-top: var(--safe-area-inset-top);
  padding-bottom: var(--safe-area-inset-bottom);
}

.safe-area-all {
  padding: var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);
}

/* Header components that need to account for notches */
.header-safe {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background-color: var(--tg-bg-color);
  border-bottom: 1px solid var(--tg-hint-color);

  /* Ensure header extends into safe area */
  padding-top: var(--safe-area-inset-top);
  padding-left: var(--safe-area-inset-left);
  padding-right: var(--safe-area-inset-right);

  /* Content padding within header */
  box-sizing: border-box;
}

.header-content {
  padding: 12px var(--content-padding-horizontal);
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* Footer/navigation that respects home indicator */
.footer-safe {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background-color: var(--tg-secondary-bg-color);
  border-top: 1px solid var(--tg-hint-color);

  /* Ensure footer extends into safe area */
  padding-bottom: var(--safe-area-inset-bottom);
  padding-left: var(--safe-area-inset-left);
  padding-right: var(--safe-area-inset-right);
}

.footer-content {
  padding: 12px var(--content-padding-horizontal);
  min-height: 44px;
}

/* Main content area that accounts for fixed headers/footers */
.main-content-safe {
  /* Account for safe areas and fixed headers/footers */
  padding-top: calc(var(--safe-area-header-height) + 20px);
  padding-bottom: calc(var(--safe-area-footer-height) + 20px);
  padding-left: var(--content-padding-horizontal);
  padding-right: var(--content-padding-horizontal);

  /* Minimum content height */
  min-height: calc(100vh - var(--safe-area-header-height) - var(--safe-area-footer-height));
  min-height: calc(100dvh - var(--safe-area-header-height) - var(--safe-area-footer-height));
}

/* Landscape orientation adjustments */
@media screen and (orientation: landscape) {
  :root {
    /* Adjust padding for landscape mode */
    --content-padding-horizontal: max(20px, var(--safe-area-inset-left), var(--safe-area-inset-right));
  }

  .telegram-webapp {
    /* Increase horizontal padding in landscape */
    padding-left: var(--content-padding-horizontal);
    padding-right: var(--content-padding-horizontal);
  }
}

/* iPhone X/11/12/13/14/15 series specific adjustments */
@supports (padding: max(0px)) {
  .telegram-webapp {
    /* Use max() for better safe area support */
    padding-top: max(var(--safe-area-inset-top), 20px);
    padding-bottom: max(var(--safe-area-inset-bottom), 20px);
    padding-left: max(var(--safe-area-inset-left), 16px);
    padding-right: max(var(--safe-area-inset-right), 16px);
  }
}

/* Fullscreen/immersive mode support */
@media (display-mode: fullscreen) {
  .telegram-webapp {
    /* Additional padding for fullscreen mode */
    padding-top: max(var(--safe-area-inset-top), 24px);
    padding-bottom: max(var(--safe-area-inset-bottom), 24px);
  }
}

/* High-density display adjustments */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .safe-area-debug {
    /* Debug visualization for safe areas */
    border: 2px solid rgba(255, 0, 0, 0.3);
  }

  .safe-area-debug::before {
    content: "Safe Area Debug";
    position: absolute;
    top: var(--safe-area-inset-top);
    left: var(--safe-area-inset-left);
    background: rgba(255, 0, 0, 0.8);
    color: white;
    padding: 4px 8px;
    font-size: 12px;
    border-radius: 4px;
    z-index: 9999;
  }
}

/* Loading states */
.loading {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
  color: var(--tg-hint-color);
}

/* Error states */
.error {
  background-color: #ff3b30;
  color: white;
  padding: 12px 16px;
  border-radius: 8px;
  margin: 8px 0;
}

/* Success states */
.success {
  background-color: #34c759;
  color: white;
  padding: 12px 16px;
  border-radius: 8px;
  margin: 8px 0;
}

/* Progress bars */
.progress-bar {
  width: 100%;
  height: 8px;
  background-color: var(--tg-secondary-bg-color);
  border-radius: 4px;
  overflow: hidden;
  margin: 8px 0;
}

.progress-bar-fill {
  height: 100%;
  background-color: var(--tg-button-color);
  transition: width 0.3s ease;
  border-radius: 4px;
}

/* Navigation styling with safe area support */
.navigation {
  display: flex;
  justify-content: space-around;
  background-color: var(--tg-secondary-bg-color);
  border-top: 1px solid var(--tg-hint-color);
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 100;

  /* Apply safe area bottom padding */
  padding: 12px var(--content-padding-horizontal) var(--safe-area-inset-bottom);

  /* Extend into safe area */
  padding-bottom: max(12px, var(--safe-area-inset-bottom));
  padding-left: var(--safe-area-inset-left);
  padding-right: var(--safe-area-inset-right);
}

.navigation-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 8px 12px;
  border-radius: 8px;
  text-decoration: none;
  color: var(--tg-hint-color);
  transition: background-color 0.2s, color 0.2s;
  min-height: 44px; /* Ensure touch target size */
  justify-content: center;
}

.navigation-item.active {
  color: var(--tg-link-color);
  background-color: var(--tg-bg-color);
}

.navigation-item:hover {
  background-color: var(--tg-bg-color);
}

/* Content padding to account for fixed navigation and safe areas */
.main-content {
  padding-bottom: calc(80px + var(--safe-area-inset-bottom));
}

/* Alternative main content with comprehensive safe area support */
.main-content-safe {
  /* Already defined above with comprehensive safe area handling */
}
